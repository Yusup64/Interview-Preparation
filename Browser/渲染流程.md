# 浏览器渲染原理与性能优化

## 1.进程与线程

- 进程是操作系统的资源分配的基本单位，进程中包含线程
- 线程是有进程管理的。为了提升浏览器的稳定性和安全性，浏览器采用了多进程模型。

### 浏览器中的（5 个）进程

![Model](https://img-blog.csdnimg.cn/2020012316114580.jpeg)

- `浏览器主进程 Browser Process`\
  负责浏览器界面的显示与交互。各个页面的管理,创建和销毁其他进程。网络的资源管理、下载等。
- `渲染进程 Renderer Process`\
  称为浏览器渲染进程或浏览器内核,内部是多线程的。主要负责页面渲染,脚本执行,事件处理等。(本文重点分析)
- `网络进程`\
  主要处理网络资源加载（`HTML`,`CSS`,`JS`等）
- `第三方插件进程 Plugin Process`\
  每种类型的插件对应一个进程,仅当使用该插件时才创建。
- `GPU 进程 GPU Process`\
  最多只有一个,用于 3D 绘制等

## 渲染流程

![Model](https://images2018.cnblogs.com/blog/1028513/201805/1028513-20180530154313816-1498972038.png)

- 1. 浏览器无法直接使用 HTML，需要将 HTML 转化为 DOM 树。(`document`)

- 2. 浏览器无法解析纯文本的`CSS`，需要将 `CSS` 转化为 `StyleSheet`。CSSOM。(`document.styleSheets`)
- 3. 计算出 DOM 树中每个节点的具体样式。（Attachment）
- 4. 创建渲染（布局）树，将 DOM 树种可见节点，添加到布居树中，并计算节点渲染到页面的坐标位置。（layout）
- 5. 通过布局树，进行分层（根据定位属性，透明属性，transform 属性，clip 属性等）产生图层树
- 6. 将不通图层数进行绘制，转交给结合成线程处理。最终产生页面，并显示到浏览器上。（Painting，Display）
